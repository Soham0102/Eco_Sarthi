{"ast":null,"code":"var _jsxFileName = \"D:\\\\Kunal Files\\\\projects\\\\janta_voice_final\\\\frontend\\\\src\\\\pages\\\\VoiceComplaint.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function VoiceComplaint() {\n  _s();\n  const [logs, setLogs] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [complaintId, setComplaintId] = useState(null);\n  const [submitted, setSubmitted] = useState(false);\n  const appendLog = line => {\n    setLogs(prev => [...prev, line]);\n  };\n  const handleVoiceComplaint = async () => {\n    setLoading(true);\n    setLogs([\"üéôÔ∏è Voice complaint started...\"]);\n    setSubmitted(false);\n    setComplaintId(null);\n    try {\n      // 1. Trigger the Python voice bot and get structured data\n      const voiceRes = await axios.get(\"http://localhost:5000/api/\");\n      if (voiceRes.data.status !== \"success\") {\n        appendLog(\"‚ùå Voice bot error: \" + voiceRes.data.message);\n        return;\n      }\n      const complaintData = voiceRes.data.data;\n      appendLog(\"‚úÖ Voice bot finished. Data:\");\n      appendLog(JSON.stringify(complaintData, null, 2));\n\n      // 2. Send that same data to the complaints endpoint\n      const formRes = await axios.post(\"http://localhost:5000/api/complaint\", {\n        name: complaintData[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ\"] || complaintData.name,\n        complaint: complaintData[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§\"] || complaintData.complaint,\n        location: complaintData[\"‡§∏‡•ç‡§•‡§æ‡§®\"] || complaintData.location\n        // map any other fields if needed\n      });\n\n      // 3. Capture and display the Complaint ID\n      const newId = formRes.data.complaintId || formRes.data.complaintId;\n      setComplaintId(newId);\n      setSubmitted(true);\n      appendLog(`üì¨ Complaint submitted. ID: ${newId}`);\n    } catch (err) {\n      appendLog(\"‚ùå Error: \" + err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-xl mx-auto mt-10 p-6 bg-white rounded shadow\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-2xl font-semibold mb-4\",\n      children: \"Voice Complaint\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleVoiceComplaint,\n      disabled: loading,\n      className: \"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50\",\n      children: loading ? \"Processing...\" : \"Start Voice Complaint\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-6 bg-gray-900 text-green-200 p-4 rounded font-mono h-48 overflow-y-scroll\",\n      children: logs.map((line, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n        children: line\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), submitted && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-6 text-green-700 font-semibold\",\n      children: [\"Complaint submitted successfully!\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 44\n      }, this), \"Your Complaint ID: \", /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"font-bold\",\n        children: complaintId\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 30\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n}\n\n// import React, { useState } from \"react\";\n// import axios from \"axios\";\n\n// export default function VoiceComplaint() {\n//   // 1. State mirrors ComplaintForm\n//   const [formData, setFormData] = useState({\n//     name: \"\",\n//     complaint: \"\",\n//     location: \"\",\n//     urgency: \"normal\",\n//   });\n\n//   const [complaintId, setComplaintId] = useState(null);\n//   const [submitted, setSubmitted] = useState(false);\n//   const [logs, setLogs] = useState([]);\n//   const [loading, setLoading] = useState(false);\n\n//   // helper to append to console‚Äëstyle logs\n//   const appendLog = (line) => setLogs((prev) => [...prev, line]);\n\n//   const handleVoiceComplaint = async () => {\n//     setLoading(true);\n//     setLogs([\"üéôÔ∏è Starting voice complaint...\"]);\n//     setSubmitted(false);\n//     setComplaintId(null);\n\n//     try {\n//       // 2. Trigger your backend voice route\n//       const voiceRes = await axios.get(\"http://localhost:5000/api/voice-complaint\");\n//       if (voiceRes.data.status !== \"success\") {\n//         appendLog(\"Thank You!\");\n//         return;\n//       }\n\n//       // 3. Pull out structured data\n//       const data = voiceRes.data.data;\n//       appendLog(\"‚úÖ Voice data received:\");\n//       appendLog(JSON.stringify(data, null, 2));\n\n//       // // 4. Map it into the exact same formData shape\n//       // const mapped = {\n//       //   name: data[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ\"] || \"\",\n//       //   location: data[\"‡§∏‡•ç‡§•‡§æ‡§®\"] || \"\",\n//       //   department: data[\"‡§µ‡§ø‡§≠‡§æ‡§ó\"] || \"\",\n//       //   description: data[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§\"] || \"\",\n//       //   urgency: \"normal\",\n//       // };\n\n//       const aiData = voiceRes.data.data;\n\n//       const payload = {\n//         name: aiData[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ\"] || \"\",\n//         location: aiData[\"‡§∏‡•ç‡§•‡§æ‡§®\"] || \"\",\n//         department: aiData[\"‡§µ‡§ø‡§≠‡§æ‡§ó\"] || \"\",\n//         description: aiData[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§\"] || \"\",\n//       };\n\n//       await axios.post(\"http://localhost:5000/api/complaint\", payload);\n\n//       setFormData(mapped);\n\n//       // 5. POST to the same endpoint as ComplaintForm\n//       const res = await axios.post(\"http://localhost:5000/api/complaint\", mapped);\n//       setComplaintId(res.data.complaintId);\n//       setSubmitted(true);\n//       appendLog(`üì¨ Complaint submitted. ID: ${res.data.complaintId}`);\n//     } catch (err) {\n//       appendLog(\"‚ùå Submission error: \" + err.message);\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   return (\n//     <div className=\"max-w-xl mx-auto mt-10 p-6 bg-white rounded shadow\">\n//       <h2 className=\"text-2xl font-semibold mb-4\">Voice Complaint</h2>\n\n//       {/* Start button */}\n//       <button\n//         onClick={handleVoiceComplaint}\n//         disabled={loading}\n//         className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50\"\n//       >\n//         {loading ? \"Processing...\" : \"Start Voice Complaint\"}\n//       </button>\n\n//       {/* Console logs */}\n//       <div className=\"mt-4 bg-gray-900 text-green-200 p-4 rounded font-mono h-48 overflow-y-scroll\">\n//         {logs.length === 0 ? <div>Logs will appear here...</div> : logs.map((l, i) => <div key={i}>{l}</div>)}\n//       </div>\n\n//       {/* Confirmation */}\n//       {submitted && (\n//         <div className=\"mt-6 text-green-700 font-semibold\">\n//           Complaint submitted successfully!<br />\n//           Your Complaint ID: <span className=\"font-bold\">{complaintId}</span>\n//         </div>\n//       )}\n//     </div>\n//   );\n// }\n\n// import React, { useState, useEffect, useRef, useCallback } from \"react\";\n// import { \n//   Phone, \n//   PhoneOff, \n//   Mic, \n//   MicOff, \n//   Volume2, \n//   VolumeX, \n//   User, \n//   Bot, \n//   CheckCircle, \n//   AlertCircle, \n//   Clock,\n//   Signal,\n//   PhoneCall\n// } from \"lucide-react\";\n\n// export default function VoiceComplaint() {\n//   const [conversation, setConversation] = useState([]);\n//   const [isListening, setIsListening] = useState(false);\n//   const [isProcessing, setIsProcessing] = useState(false);\n//   const [isSpeaking, setIsSpeaking] = useState(false);\n//   const [callActive, setCallActive] = useState(false);\n//   const [callConnecting, setCallConnecting] = useState(false);\n//   const [complaintId, setComplaintId] = useState(null);\n//   const [callStatus, setCallStatus] = useState('idle'); // idle, connecting, active, completed, error\n//   const [audioEnabled, setAudioEnabled] = useState(true);\n//   const [currentStep, setCurrentStep] = useState('');\n//   const [sessionId, setSessionId] = useState(null);\n//   const [connectionError, setConnectionError] = useState(null);\n//   const [callDuration, setCallDuration] = useState(0);\n\n//   const conversationRef = useRef(null);\n//   const eventSourceRef = useRef(null);\n//   const callStartTimeRef = useRef(null);\n//   const callTimerRef = useRef(null);\n//   const reconnectTimeoutRef = useRef(null);\n//   const maxReconnectAttempts = 3;\n//   const reconnectAttempts = useRef(0);\n\n//   // Auto-scroll to bottom when new messages arrive\n//   useEffect(() => {\n//     if (conversationRef.current) {\n//       conversationRef.current.scrollTop = conversationRef.current.scrollHeight;\n//     }\n//   }, [conversation]);\n\n//   // Call duration timer\n//   useEffect(() => {\n//     if (callActive && callStartTimeRef.current) {\n//       callTimerRef.current = setInterval(() => {\n//         const elapsed = Math.floor((Date.now() - callStartTimeRef.current) / 1000);\n//         setCallDuration(elapsed);\n//       }, 1000);\n//     } else {\n//       if (callTimerRef.current) {\n//         clearInterval(callTimerRef.current);\n//         callTimerRef.current = null;\n//       }\n//     }\n\n//     return () => {\n//       if (callTimerRef.current) {\n//         clearInterval(callTimerRef.current);\n//       }\n//     };\n//   }, [callActive]);\n\n//   // Cleanup on component unmount\n//   useEffect(() => {\n//     return () => {\n//       endCall();\n//       if (reconnectTimeoutRef.current) {\n//         clearTimeout(reconnectTimeoutRef.current);\n//       }\n//     };\n//   }, []);\n\n//   const formatTime = (seconds) => {\n//     const mins = Math.floor(seconds / 60);\n//     const secs = seconds % 60;\n//     return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n//   };\n\n//   const addMessage = useCallback((sender, message, type = 'text', metadata = {}) => {\n//     const newMessage = {\n//       id: Date.now() + Math.random(),\n//       sender, // 'bot' or 'user'\n//       message,\n//       type, // 'text', 'status', 'json', 'error', 'system'\n//       timestamp: new Date(),\n//       metadata\n//     };\n//     setConversation(prev => [...prev, newMessage]);\n//   }, []);\n\n//   const startCall = async () => {\n//     try {\n//       setCallConnecting(true);\n//       setCallStatus('connecting');\n//       setConversation([]);\n//       setConnectionError(null);\n//       reconnectAttempts.current = 0;\n\n//       addMessage('system', '‡§ï‡•â‡§≤ ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...', 'status');\n\n//       // Start voice session\n//       const response = await fetch('http://localhost:5000/api/start-voice-session', { \n//         method: 'POST',\n//         credentials: 'include',\n//         headers: {\n//           'Content-Type': 'application/json',\n//         }\n//       });\n\n//       if (!response.ok) {\n//         throw new Error(`HTTP error! status: ${response.status}`);\n//       }\n\n//       const data = await response.json();\n\n//       if (!data.success) {\n//         throw new Error(data.error || 'Failed to start session');\n//       }\n\n//       setSessionId(data.session_id);\n\n//       // Wait a moment for session to initialize\n//       await new Promise(resolve => setTimeout(resolve, 1000));\n\n//       // Start SSE connection\n//       await setupSSEConnection();\n\n//     } catch (error) {\n//       console.error('Error starting call:', error);\n//       setConnectionError(error.message);\n//       addMessage('system', `‡§ï‡•â‡§≤ ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ: ${error.message}`, 'error');\n//       setCallConnecting(false);\n//       setCallStatus('error');\n//     }\n//   };\n\n//   const setupSSEConnection = async () => {\n//     try {\n//       // Close existing connection\n//       if (eventSourceRef.current) {\n//         eventSourceRef.current.close();\n//       }\n\n//       eventSourceRef.current = new EventSource('http://localhost:5000/api/voice-complaint-stream', {\n//         withCredentials: true\n//       });\n\n//       eventSourceRef.current.onopen = () => {\n//         console.log('SSE connection opened');\n//         setCallConnecting(false);\n//         setCallActive(true);\n//         setCallStatus('active');\n//         callStartTimeRef.current = Date.now();\n//         setCallDuration(0);\n//         addMessage('system', '‡§ï‡•â‡§≤ ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§π‡•ã ‡§ó‡§à ‡§π‡•à', 'status');\n//         reconnectAttempts.current = 0;\n//       };\n\n//       eventSourceRef.current.onmessage = (event) => {\n//         try {\n//           const data = JSON.parse(event.data);\n//           handleRealtimeUpdate(data);\n//         } catch (error) {\n//           console.error('Error parsing SSE data:', error);\n//         }\n//       };\n\n//       eventSourceRef.current.onerror = (error) => {\n//         console.error('SSE Error:', error);\n\n//         if (reconnectAttempts.current < maxReconnectAttempts) {\n//           addMessage('system', '‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ, ‡§™‡•Å‡§®‡§É ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...', 'status');\n//           reconnectAttempts.current += 1;\n\n//           reconnectTimeoutRef.current = setTimeout(() => {\n//             if (callActive) {\n//               setupSSEConnection();\n//             }\n//           }, 2000 * reconnectAttempts.current); // Exponential backoff\n//         } else {\n//           addMessage('system', '‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§≤‡§ó‡§æ‡§§‡§æ‡§∞ ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§¶‡•ã‡§¨‡§æ‡§∞‡§æ ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç‡•§', 'error');\n//           endCall();\n//         }\n//       };\n\n//     } catch (error) {\n//       console.error('Error setting up SSE:', error);\n//       setConnectionError(error.message);\n//       endCall();\n//     }\n//   };\n\n//   const handleRealtimeUpdate = useCallback((data) => {\n//     if (!data || !data.type) return;\n\n//     console.log('Received update:', data.type, data);\n\n//     switch (data.type) {\n//       case 'connected':\n//         addMessage('system', '‡§ï‡•â‡§≤ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§π‡•Å‡§à', 'status');\n//         break;\n\n//       case 'bot_question':\n//       case 'bot_speaking':\n//         setIsSpeaking(true);\n//         setCurrentStep(data.step || '‡§¨‡•ã‡§ü ‡§¨‡•ã‡§≤ ‡§∞‡§π‡§æ ‡§π‡•à');\n//         addMessage('bot', data.message, 'text', { step: data.step });\n//         // Simulate speaking duration based on message length\n//         const speakingDuration = Math.max(2000, data.message.length * 100);\n//         setTimeout(() => setIsSpeaking(false), speakingDuration);\n//         break;\n\n//       case 'listening_start':\n//         setIsListening(true);\n//         setIsSpeaking(false);\n//         setIsProcessing(false);\n//         setCurrentStep('‡§Ü‡§™‡§ï‡•Ä ‡§Ü‡§µ‡§æ‡§ú‡§º ‡§∏‡•Å‡§® ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...');\n//         addMessage('system', '‡§Ö‡§¨ ‡§¨‡•ã‡§≤‡•á‡§Ç...', 'status');\n//         break;\n\n//       case 'listening_end':\n//         setIsListening(false);\n//         setCurrentStep('‡§Ü‡§™‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§∏‡§Æ‡§ù ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...');\n//         break;\n\n//       case 'user_response':\n//         setIsProcessing(false);\n//         addMessage('user', data.message, 'text');\n//         setCurrentStep('');\n//         break;\n\n//       case 'processing':\n//         setIsProcessing(true);\n//         setCurrentStep(data.message || '‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏‡§ø‡§Ç‡§ó...');\n//         break;\n\n//       case 'complaint_structured':\n//         setCallStatus('processing');\n//         addMessage('bot', '‡§Ü‡§™‡§ï‡•Ä ‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•ã ‡§ó‡§Ø‡§æ:', 'status');\n//         if (data.data) {\n//           addMessage('bot', JSON.stringify(data.data, null, 2), 'json', { complaintData: data.data });\n//         }\n//         break;\n\n//       case 'complaint_submitted':\n//         setCallStatus('completed');\n//         setComplaintId(data.complaintId);\n//         addMessage('bot', `‡§Ü‡§™‡§ï‡•Ä ‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§¶‡§∞‡•ç‡§ú ‡§π‡•ã ‡§ó‡§à ‡§π‡•à!`, 'status');\n//         addMessage('bot', `‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§®‡§Ç‡§¨‡§∞: ${data.complaintId}`, 'text', { complaintId: data.complaintId });\n//         setCurrentStep('‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§¶‡§∞‡•ç‡§ú ‡§π‡•ã ‡§ó‡§à');\n//         // Auto end call after 5 seconds\n//         setTimeout(() => endCall(), 5000);\n//         break;\n\n//       case 'summary':\n//         addMessage('bot', data.message, 'status');\n//         break;\n\n//       case 'final_message':\n//         addMessage('bot', data.message, 'status');\n//         break;\n\n//       case 'error':\n//         addMessage('bot', data.message, 'error');\n//         setCallStatus('error');\n//         break;\n\n//       case 'retry':\n//         addMessage('system', data.message, 'status');\n//         break;\n\n//       case 'validation_error':\n//         addMessage('bot', data.message, 'error');\n//         break;\n\n//       case 'session_ended':\n//         addMessage('system', '‡§ï‡•â‡§≤ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã ‡§ó‡§à', 'status');\n//         endCall();\n//         break;\n\n//       case 'heartbeat':\n//         // Keep connection alive, don't show to user\n//         break;\n\n//       default:\n//         console.log('Unknown message type:', data.type, data);\n//     }\n//   }, [addMessage]);\n\n//   const endCall = async () => {\n//     try {\n//       // Stop backend session\n//       if (sessionId) {\n//         await fetch('http://localhost:5000/api/stop-voice-session', { \n//           method: 'POST',\n//           credentials: 'include'\n//         });\n//       }\n//     } catch (error) {\n//       console.error('Error stopping session:', error);\n//     }\n\n//     // Cleanup local state\n//     if (eventSourceRef.current) {\n//       eventSourceRef.current.close();\n//       eventSourceRef.current = null;\n//     }\n\n//     if (callTimerRef.current) {\n//       clearInterval(callTimerRef.current);\n//       callTimerRef.current = null;\n//     }\n\n//     if (reconnectTimeoutRef.current) {\n//       clearTimeout(reconnectTimeoutRef.current);\n//       reconnectTimeoutRef.current = null;\n//     }\n\n//     setCallActive(false);\n//     setCallConnecting(false);\n//     setIsListening(false);\n//     setIsProcessing(false);\n//     setIsSpeaking(false);\n//     setCurrentStep('');\n//     setSessionId(null);\n//     callStartTimeRef.current = null;\n//     setCallDuration(0);\n\n//     if (callStatus !== 'completed') {\n//       setCallStatus('idle');\n//       addMessage('system', '‡§ï‡•â‡§≤ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã ‡§ó‡§à', 'status');\n//     }\n//   };\n\n//   const formatMessage = (msg) => {\n//     if (msg.type === 'json') {\n//       try {\n//         const data = JSON.parse(msg.message);\n//         return (\n//           <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3 mt-2\">\n//             <h4 className=\"font-semibold text-blue-800 mb-2\">‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£:</h4>\n//             <div className=\"space-y-1 text-sm\">\n//               {data[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ\"] && (\n//                 <p><span className=\"font-medium\">‡§®‡§æ‡§Æ:</span> {data[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ\"]}</p>\n//               )}\n//               {data[\"‡§∏‡•ç‡§•‡§æ‡§®\"] && (\n//                 <p><span className=\"font-medium\">‡§∏‡•ç‡§•‡§æ‡§®:</span> {data[\"‡§∏‡•ç‡§•‡§æ‡§®\"]}</p>\n//               )}\n//               {data[\"‡§µ‡§ø‡§≠‡§æ‡§ó\"] && (\n//                 <p><span className=\"font-medium\">‡§µ‡§ø‡§≠‡§æ‡§ó:</span> {data[\"‡§µ‡§ø‡§≠‡§æ‡§ó\"]}</p>\n//               )}\n//               {data[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§\"] && (\n//                 <p><span className=\"font-medium\">‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§:</span> {data[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§\"]}</p>\n//               )}\n//               {data[\"‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞\"] && (\n//                 <p><span className=\"font-medium\">‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤:</span> {data[\"‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞\"]}</p>\n//               )}\n//             </div>\n//           </div>\n//         );\n//       } catch (e) {\n//         return <pre className=\"text-xs bg-gray-100 p-2 rounded overflow-x-auto\">{msg.message}</pre>;\n//       }\n//     }\n//     return msg.message;\n//   };\n\n//   const getMessageIcon = (msg) => {\n//     if (msg.sender === 'bot') {\n//       if (msg.type === 'error') return <AlertCircle className=\"w-4 h-4 text-red-500\" />;\n//       if (msg.type === 'status') return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\n//       return <Bot className=\"w-4 h-4 text-blue-500\" />;\n//     }\n//     if (msg.sender === 'system') {\n//       return <Signal className=\"w-4 h-4 text-gray-500\" />;\n//     }\n//     return <User className=\"w-4 h-4 text-purple-500\" />;\n//   };\n\n//   const getCallStatusColor = () => {\n//     switch (callStatus) {\n//       case 'connecting': return 'text-yellow-600 bg-yellow-100 border-yellow-200';\n//       case 'active': return 'text-green-600 bg-green-100 border-green-200';\n//       case 'processing': return 'text-blue-600 bg-blue-100 border-blue-200';\n//       case 'completed': return 'text-green-600 bg-green-100 border-green-200';\n//       case 'error': return 'text-red-600 bg-red-100 border-red-200';\n//       default: return 'text-gray-600 bg-gray-100 border-gray-200';\n//     }\n//   };\n\n//   const getCallStatusText = () => {\n//     switch (callStatus) {\n//       case 'connecting': return '‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...';\n//       case 'active': return '‡§ï‡•â‡§≤ ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø';\n//       case 'processing': return '‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à';\n//       case 'completed': return '‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§™‡•Ç‡§∞‡•ç‡§£';\n//       case 'error': return '‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ';\n//       default: return '‡§§‡•à‡§Ø‡§æ‡§∞';\n//     }\n//   };\n\n//   return (\n//     <div className=\"max-w-4xl mx-auto mt-6 p-6 bg-white rounded-xl shadow-lg\">\n//       {/* Header */}\n//       <div className=\"text-center mb-6\">\n//         <div className=\"flex items-center justify-center mb-4\">\n//           <PhoneCall className=\"w-8 h-8 text-blue-600 mr-3\" />\n//           <h2 className=\"text-3xl font-bold text-gray-900\">‡§ú‡§®‡§§‡§æ ‡§µ‡•â‡§á‡§∏ ‡§ï‡•â‡§≤</h2>\n//         </div>\n//         <p className=\"text-gray-600\">‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§®‡•Ä ‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç</p>\n//       </div>\n\n//       {/* Call Status Bar */}\n//       <div className={`flex items-center justify-between p-4 rounded-lg mb-6 border ${getCallStatusColor()}`}>\n//         <div className=\"flex items-center space-x-3\">\n//           <div className=\"flex items-center space-x-2\">\n//             {callConnecting && <Clock className=\"w-5 h-5 animate-spin\" />}\n//             {callActive && !isListening && !isSpeaking && !isProcessing && (\n//               <Signal className=\"w-5 h-5 animate-pulse\" />\n//             )}\n//             {isListening && <Mic className=\"w-5 h-5 animate-pulse text-green-600\" />}\n//             {isSpeaking && <Volume2 className=\"w-5 h-5 animate-pulse text-blue-600\" />}\n//             {isProcessing && <Clock className=\"w-5 h-5 animate-spin text-yellow-600\" />}\n//             <span className=\"font-medium\">\n//               {currentStep || getCallStatusText()}\n//             </span>\n//           </div>\n//         </div>\n//         <div className=\"text-sm font-mono\">\n//           {callActive && `${formatTime(callDuration)}`}\n//         </div>\n//       </div>\n\n//       {/* Call Control */}\n//       <div className=\"flex justify-center mb-6\">\n//         {!callActive && !callConnecting ? (\n//           <button\n//             onClick={startCall}\n//             disabled={callConnecting}\n//             className=\"flex items-center space-x-3 bg-green-600 text-white px-8 py-4 rounded-full hover:bg-green-700 transition-colors font-medium text-lg shadow-lg transform hover:scale-105\"\n//           >\n//             <Phone className=\"w-6 h-6\" />\n//             <span>‡§ï‡•â‡§≤ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</span>\n//           </button>\n//         ) : (\n//           <button\n//             onClick={endCall}\n//             className=\"flex items-center space-x-3 bg-red-600 text-white px-8 py-4 rounded-full hover:bg-red-700 transition-colors font-medium text-lg shadow-lg transform hover:scale-105\"\n//           >\n//             <PhoneOff className=\"w-6 h-6\" />\n//             <span>‡§ï‡•â‡§≤ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç</span>\n//           </button>\n//         )}\n//       </div>\n\n//       {/* Connection Error */}\n//       {connectionError && (\n//         <div className=\"mb-4 p-3 bg-red-100 border border-red-200 text-red-700 rounded-lg\">\n//           <div className=\"flex items-center space-x-2\">\n//             <AlertCircle className=\"w-5 h-5\" />\n//             <span>‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§è‡§∞‡§∞: {connectionError}</span>\n//           </div>\n//         </div>\n//       )}\n\n//       {/* Call Log */}\n//       <div \n//         ref={conversationRef}\n//         className=\"bg-gray-900 text-white rounded-lg p-4 h-96 overflow-y-auto border border-gray-700\"\n//         style={{\n//           background: 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)',\n//           fontFamily: 'monospace'\n//         }}\n//       >\n//         {conversation.length === 0 ? (\n//           <div className=\"flex items-center justify-center h-full text-gray-400\">\n//             <div className=\"text-center\">\n//               <PhoneCall className=\"w-12 h-12 mx-auto mb-3 text-gray-500\" />\n//               <p>‡§ï‡•â‡§≤ ‡§≤‡•â‡§ó ‡§Ø‡§π‡§æ‡§Å ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§ú‡§æ‡§è‡§ó‡§æ...</p>\n//             </div>\n//           </div>\n//         ) : (\n//           <div className=\"space-y-3\">\n//             {conversation.map((msg) => (\n//               <div\n//                 key={msg.id}\n//                 className=\"flex items-start space-x-3\"\n//               >\n//                 <div className=\"flex-shrink-0 text-xs text-gray-400 w-16\">\n//                   {msg.timestamp.toLocaleTimeString('hi-IN', { \n//                     hour12: false,\n//                     hour: '2-digit',\n//                     minute: '2-digit',\n//                     second: '2-digit'\n//                   })}\n//                 </div>\n//                 <div className={`flex-shrink-0 p-1 rounded-full ${\n//                   msg.sender === 'user' ? 'bg-purple-600' : \n//                   msg.sender === 'system' ? 'bg-gray-600' :\n//                   msg.type === 'error' ? 'bg-red-600' :\n//                   msg.type === 'status' ? 'bg-green-600' : 'bg-blue-600'\n//                 }`}>\n//                   {getMessageIcon(msg)}\n//                 </div>\n//                 <div className=\"flex-1\">\n//                   <div className={`text-sm ${\n//                     msg.sender === 'user' \n//                       ? 'text-purple-300' \n//                       : msg.sender === 'system'\n//                       ? 'text-gray-300'\n//                       : msg.type === 'error'\n//                       ? 'text-red-300'\n//                       : msg.type === 'status'\n//                       ? 'text-green-300'\n//                       : 'text-blue-300'\n//                   }`}>\n//                     <span className=\"font-medium\">\n//                       {msg.sender === 'user' ? '‡§Ü‡§™' : \n//                        msg.sender === 'system' ? '‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ' : '‡§¨‡•â‡§ü'}:\n//                     </span>\n//                   </div>\n//                   <div className=\"text-white text-sm mt-1 break-words\">\n//                     {formatMessage(msg)}\n//                   </div>\n//                 </div>\n//               </div>\n//             ))}\n//           </div>\n//         )}\n//       </div>\n\n//       {/* Current Activity Indicator */}\n//       {callActive && (\n//         <div className=\"mt-4 flex items-center justify-center space-x-4 text-sm\">\n//           {isListening && (\n//             <div className=\"flex items-center space-x-2 bg-green-100 px-4 py-2 rounded-full border border-green-200\">\n//               <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n//               <Mic className=\"w-4 h-4 text-green-600\" />\n//               <span className=\"text-green-700 font-medium\">‡§∏‡•Å‡§® ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...</span>\n//             </div>\n//           )}\n//           {isSpeaking && (\n//             <div className=\"flex items-center space-x-2 bg-blue-100 px-4 py-2 rounded-full border border-blue-200\">\n//               <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\"></div>\n//               <Volume2 className=\"w-4 h-4 text-blue-600\" />\n//               <span className=\"text-blue-700 font-medium\">‡§¨‡•â‡§ü ‡§¨‡•ã‡§≤ ‡§∞‡§π‡§æ ‡§π‡•à...</span>\n//             </div>\n//           )}\n//           {isProcessing && (\n//             <div className=\"flex items-center space-x-2 bg-yellow-100 px-4 py-2 rounded-full border border-yellow-200\">\n//               <div className=\"w-2 h-2 bg-yellow-500 rounded-full animate-pulse\"></div>\n//               <Clock className=\"w-4 h-4 text-yellow-600\" />\n//               <span className=\"text-yellow-700 font-medium\">‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏‡§ø‡§Ç‡§ó...</span>\n//             </div>\n//           )}\n//         </div>\n//       )}\n\n//       {/* Final Result */}\n//       {complaintId && (\n//         <div className=\"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg\">\n//           <div className=\"flex items-center justify-between\">\n//             <div>\n//               <h3 className=\"font-semibold text-green-800 flex items-center space-x-2\">\n//                 <CheckCircle className=\"w-5 h-5\" />\n//                 <span>‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§¶‡§∞‡•ç‡§ú!</span>\n//               </h3>\n//               <p className=\"text-green-700 mt-1\">\n//                 ‡§Ü‡§™‡§ï‡§æ ‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§®‡§Ç‡§¨‡§∞: <span className=\"font-mono font-bold text-lg\">{complaintId}</span>\n//               </p>\n//               <p className=\"text-green-600 text-sm mt-1\">\n//                 ‡§ï‡•É‡§™‡§Ø‡§æ ‡§á‡§∏ ‡§®‡§Ç‡§¨‡§∞ ‡§ï‡•ã ‡§Ö‡§™‡§®‡•á ‡§™‡§æ‡§∏ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§∞‡§ñ‡•á‡§Ç\n//               </p>\n//             </div>\n//           </div>\n//         </div>\n//       )}\n\n//       {/* Audio Controls */}\n//       <div className=\"mt-4 flex justify-center\">\n//         <button\n//           onClick={() => setAudioEnabled(!audioEnabled)}\n//           className={`flex items-center space-x-2 px-4 py-2 rounded-lg text-sm ${\n//             audioEnabled \n//               ? 'bg-green-100 text-green-700 hover:bg-green-200' \n//               : 'bg-red-100 text-red-700 hover:bg-red-200'\n//           } transition-colors`}\n//         >\n//           {audioEnabled ? <Volume2 className=\"w-4 h-4\" /> : <VolumeX className=\"w-4 h-4\" />}\n//           <span>{audioEnabled ? '‡§Ü‡§µ‡§æ‡§ú‡§º ‡§ö‡§æ‡§≤‡•Ç' : '‡§Ü‡§µ‡§æ‡§ú‡§º ‡§¨‡§Ç‡§¶'}</span>\n//         </button>\n//       </div>\n//     </div>\n//   );\n// }\n_s(VoiceComplaint, \"XRUUZp/E5ruB2VLYF7IwAMT576U=\");\n_c = VoiceComplaint;\nvar _c;\n$RefreshReg$(_c, \"VoiceComplaint\");","map":{"version":3,"names":["React","useState","axios","jsxDEV","_jsxDEV","VoiceComplaint","_s","logs","setLogs","loading","setLoading","complaintId","setComplaintId","submitted","setSubmitted","appendLog","line","prev","handleVoiceComplaint","voiceRes","get","data","status","message","complaintData","JSON","stringify","formRes","post","name","complaint","location","newId","err","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","map","i","_c","$RefreshReg$"],"sources":["D:/Kunal Files/projects/janta_voice_final/frontend/src/pages/VoiceComplaint.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nexport default function VoiceComplaint() {\r\n  const [logs, setLogs] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [complaintId, setComplaintId] = useState(null);\r\n  const [submitted, setSubmitted] = useState(false);\r\n\r\n  const appendLog = (line) => {\r\n    setLogs((prev) => [...prev, line]);\r\n  };\r\n\r\n  const handleVoiceComplaint = async () => {\r\n    setLoading(true);\r\n    setLogs([\"üéôÔ∏è Voice complaint started...\"]);\r\n    setSubmitted(false);\r\n    setComplaintId(null);\r\n\r\n    try {\r\n      // 1. Trigger the Python voice bot and get structured data\r\n      const voiceRes = await axios.get(\"http://localhost:5000/api/\");\r\n      if (voiceRes.data.status !== \"success\") {\r\n        appendLog(\"‚ùå Voice bot error: \" + voiceRes.data.message);\r\n        return;\r\n      }\r\n\r\n      const complaintData = voiceRes.data.data;\r\n      appendLog(\"‚úÖ Voice bot finished. Data:\");\r\n      appendLog(JSON.stringify(complaintData, null, 2));\r\n\r\n      // 2. Send that same data to the complaints endpoint\r\n      const formRes = await axios.post(\r\n        \"http://localhost:5000/api/complaint\",\r\n        {\r\n          name: complaintData[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ\"] || complaintData.name,\r\n          complaint: complaintData[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§\"] || complaintData.complaint,\r\n          location: complaintData[\"‡§∏‡•ç‡§•‡§æ‡§®\"] || complaintData.location,\r\n          // map any other fields if needed\r\n        }\r\n      );\r\n\r\n      // 3. Capture and display the Complaint ID\r\n      const newId = formRes.data.complaintId || formRes.data.complaintId;\r\n      setComplaintId(newId);\r\n      setSubmitted(true);\r\n      appendLog(`üì¨ Complaint submitted. ID: ${newId}`);\r\n    } catch (err) {\r\n      appendLog(\"‚ùå Error: \" + err.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-xl mx-auto mt-10 p-6 bg-white rounded shadow\">\r\n      <h2 className=\"text-2xl font-semibold mb-4\">Voice Complaint</h2>\r\n      <button\r\n        onClick={handleVoiceComplaint}\r\n        disabled={loading}\r\n        className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50\"\r\n      >\r\n        {loading ? \"Processing...\" : \"Start Voice Complaint\"}\r\n      </button>\r\n\r\n      <div className=\"mt-6 bg-gray-900 text-green-200 p-4 rounded font-mono h-48 overflow-y-scroll\">\r\n        {logs.map((line, i) => (\r\n          <div key={i}>{line}</div>\r\n        ))}\r\n      </div>\r\n\r\n      {submitted && (\r\n        <div className=\"mt-6 text-green-700 font-semibold\">\r\n          Complaint submitted successfully!<br />\r\n          Your Complaint ID: <span className=\"font-bold\">{complaintId}</span>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n// import React, { useState } from \"react\";\r\n// import axios from \"axios\";\r\n\r\n// export default function VoiceComplaint() {\r\n//   // 1. State mirrors ComplaintForm\r\n//   const [formData, setFormData] = useState({\r\n//     name: \"\",\r\n//     complaint: \"\",\r\n//     location: \"\",\r\n//     urgency: \"normal\",\r\n//   });\r\n\r\n//   const [complaintId, setComplaintId] = useState(null);\r\n//   const [submitted, setSubmitted] = useState(false);\r\n//   const [logs, setLogs] = useState([]);\r\n//   const [loading, setLoading] = useState(false);\r\n\r\n//   // helper to append to console‚Äëstyle logs\r\n//   const appendLog = (line) => setLogs((prev) => [...prev, line]);\r\n\r\n//   const handleVoiceComplaint = async () => {\r\n//     setLoading(true);\r\n//     setLogs([\"üéôÔ∏è Starting voice complaint...\"]);\r\n//     setSubmitted(false);\r\n//     setComplaintId(null);\r\n\r\n//     try {\r\n//       // 2. Trigger your backend voice route\r\n//       const voiceRes = await axios.get(\"http://localhost:5000/api/voice-complaint\");\r\n//       if (voiceRes.data.status !== \"success\") {\r\n//         appendLog(\"Thank You!\");\r\n//         return;\r\n//       }\r\n\r\n//       // 3. Pull out structured data\r\n//       const data = voiceRes.data.data;\r\n//       appendLog(\"‚úÖ Voice data received:\");\r\n//       appendLog(JSON.stringify(data, null, 2));\r\n\r\n\r\n//       // // 4. Map it into the exact same formData shape\r\n//       // const mapped = {\r\n//       //   name: data[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ\"] || \"\",\r\n//       //   location: data[\"‡§∏‡•ç‡§•‡§æ‡§®\"] || \"\",\r\n//       //   department: data[\"‡§µ‡§ø‡§≠‡§æ‡§ó\"] || \"\",\r\n//       //   description: data[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§\"] || \"\",\r\n//       //   urgency: \"normal\",\r\n//       // };\r\n\r\n//       const aiData = voiceRes.data.data;\r\n\r\n//       const payload = {\r\n//         name: aiData[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ\"] || \"\",\r\n//         location: aiData[\"‡§∏‡•ç‡§•‡§æ‡§®\"] || \"\",\r\n//         department: aiData[\"‡§µ‡§ø‡§≠‡§æ‡§ó\"] || \"\",\r\n//         description: aiData[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§\"] || \"\",\r\n//       };\r\n\r\n//       await axios.post(\"http://localhost:5000/api/complaint\", payload);\r\n\r\n\r\n//       setFormData(mapped);\r\n\r\n//       // 5. POST to the same endpoint as ComplaintForm\r\n//       const res = await axios.post(\"http://localhost:5000/api/complaint\", mapped);\r\n//       setComplaintId(res.data.complaintId);\r\n//       setSubmitted(true);\r\n//       appendLog(`üì¨ Complaint submitted. ID: ${res.data.complaintId}`);\r\n//     } catch (err) {\r\n//       appendLog(\"‚ùå Submission error: \" + err.message);\r\n//     } finally {\r\n//       setLoading(false);\r\n//     }\r\n//   };\r\n\r\n//   return (\r\n//     <div className=\"max-w-xl mx-auto mt-10 p-6 bg-white rounded shadow\">\r\n//       <h2 className=\"text-2xl font-semibold mb-4\">Voice Complaint</h2>\r\n\r\n//       {/* Start button */}\r\n//       <button\r\n//         onClick={handleVoiceComplaint}\r\n//         disabled={loading}\r\n//         className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50\"\r\n//       >\r\n//         {loading ? \"Processing...\" : \"Start Voice Complaint\"}\r\n//       </button>\r\n\r\n//       {/* Console logs */}\r\n//       <div className=\"mt-4 bg-gray-900 text-green-200 p-4 rounded font-mono h-48 overflow-y-scroll\">\r\n//         {logs.length === 0 ? <div>Logs will appear here...</div> : logs.map((l, i) => <div key={i}>{l}</div>)}\r\n//       </div>\r\n\r\n//       {/* Confirmation */}\r\n//       {submitted && (\r\n//         <div className=\"mt-6 text-green-700 font-semibold\">\r\n//           Complaint submitted successfully!<br />\r\n//           Your Complaint ID: <span className=\"font-bold\">{complaintId}</span>\r\n//         </div>\r\n//       )}\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n\r\n\r\n// import React, { useState, useEffect, useRef, useCallback } from \"react\";\r\n// import { \r\n//   Phone, \r\n//   PhoneOff, \r\n//   Mic, \r\n//   MicOff, \r\n//   Volume2, \r\n//   VolumeX, \r\n//   User, \r\n//   Bot, \r\n//   CheckCircle, \r\n//   AlertCircle, \r\n//   Clock,\r\n//   Signal,\r\n//   PhoneCall\r\n// } from \"lucide-react\";\r\n\r\n// export default function VoiceComplaint() {\r\n//   const [conversation, setConversation] = useState([]);\r\n//   const [isListening, setIsListening] = useState(false);\r\n//   const [isProcessing, setIsProcessing] = useState(false);\r\n//   const [isSpeaking, setIsSpeaking] = useState(false);\r\n//   const [callActive, setCallActive] = useState(false);\r\n//   const [callConnecting, setCallConnecting] = useState(false);\r\n//   const [complaintId, setComplaintId] = useState(null);\r\n//   const [callStatus, setCallStatus] = useState('idle'); // idle, connecting, active, completed, error\r\n//   const [audioEnabled, setAudioEnabled] = useState(true);\r\n//   const [currentStep, setCurrentStep] = useState('');\r\n//   const [sessionId, setSessionId] = useState(null);\r\n//   const [connectionError, setConnectionError] = useState(null);\r\n//   const [callDuration, setCallDuration] = useState(0);\r\n  \r\n//   const conversationRef = useRef(null);\r\n//   const eventSourceRef = useRef(null);\r\n//   const callStartTimeRef = useRef(null);\r\n//   const callTimerRef = useRef(null);\r\n//   const reconnectTimeoutRef = useRef(null);\r\n//   const maxReconnectAttempts = 3;\r\n//   const reconnectAttempts = useRef(0);\r\n\r\n//   // Auto-scroll to bottom when new messages arrive\r\n//   useEffect(() => {\r\n//     if (conversationRef.current) {\r\n//       conversationRef.current.scrollTop = conversationRef.current.scrollHeight;\r\n//     }\r\n//   }, [conversation]);\r\n\r\n//   // Call duration timer\r\n//   useEffect(() => {\r\n//     if (callActive && callStartTimeRef.current) {\r\n//       callTimerRef.current = setInterval(() => {\r\n//         const elapsed = Math.floor((Date.now() - callStartTimeRef.current) / 1000);\r\n//         setCallDuration(elapsed);\r\n//       }, 1000);\r\n//     } else {\r\n//       if (callTimerRef.current) {\r\n//         clearInterval(callTimerRef.current);\r\n//         callTimerRef.current = null;\r\n//       }\r\n//     }\r\n\r\n//     return () => {\r\n//       if (callTimerRef.current) {\r\n//         clearInterval(callTimerRef.current);\r\n//       }\r\n//     };\r\n//   }, [callActive]);\r\n\r\n//   // Cleanup on component unmount\r\n//   useEffect(() => {\r\n//     return () => {\r\n//       endCall();\r\n//       if (reconnectTimeoutRef.current) {\r\n//         clearTimeout(reconnectTimeoutRef.current);\r\n//       }\r\n//     };\r\n//   }, []);\r\n\r\n//   const formatTime = (seconds) => {\r\n//     const mins = Math.floor(seconds / 60);\r\n//     const secs = seconds % 60;\r\n//     return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\r\n//   };\r\n\r\n//   const addMessage = useCallback((sender, message, type = 'text', metadata = {}) => {\r\n//     const newMessage = {\r\n//       id: Date.now() + Math.random(),\r\n//       sender, // 'bot' or 'user'\r\n//       message,\r\n//       type, // 'text', 'status', 'json', 'error', 'system'\r\n//       timestamp: new Date(),\r\n//       metadata\r\n//     };\r\n//     setConversation(prev => [...prev, newMessage]);\r\n//   }, []);\r\n\r\n//   const startCall = async () => {\r\n//     try {\r\n//       setCallConnecting(true);\r\n//       setCallStatus('connecting');\r\n//       setConversation([]);\r\n//       setConnectionError(null);\r\n//       reconnectAttempts.current = 0;\r\n      \r\n//       addMessage('system', '‡§ï‡•â‡§≤ ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...', 'status');\r\n      \r\n//       // Start voice session\r\n//       const response = await fetch('http://localhost:5000/api/start-voice-session', { \r\n//         method: 'POST',\r\n//         credentials: 'include',\r\n//         headers: {\r\n//           'Content-Type': 'application/json',\r\n//         }\r\n//       });\r\n\r\n//       if (!response.ok) {\r\n//         throw new Error(`HTTP error! status: ${response.status}`);\r\n//       }\r\n\r\n//       const data = await response.json();\r\n      \r\n//       if (!data.success) {\r\n//         throw new Error(data.error || 'Failed to start session');\r\n//       }\r\n\r\n//       setSessionId(data.session_id);\r\n      \r\n//       // Wait a moment for session to initialize\r\n//       await new Promise(resolve => setTimeout(resolve, 1000));\r\n      \r\n//       // Start SSE connection\r\n//       await setupSSEConnection();\r\n      \r\n//     } catch (error) {\r\n//       console.error('Error starting call:', error);\r\n//       setConnectionError(error.message);\r\n//       addMessage('system', `‡§ï‡•â‡§≤ ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ: ${error.message}`, 'error');\r\n//       setCallConnecting(false);\r\n//       setCallStatus('error');\r\n//     }\r\n//   };\r\n\r\n//   const setupSSEConnection = async () => {\r\n//     try {\r\n//       // Close existing connection\r\n//       if (eventSourceRef.current) {\r\n//         eventSourceRef.current.close();\r\n//       }\r\n\r\n//       eventSourceRef.current = new EventSource('http://localhost:5000/api/voice-complaint-stream', {\r\n//         withCredentials: true\r\n//       });\r\n      \r\n//       eventSourceRef.current.onopen = () => {\r\n//         console.log('SSE connection opened');\r\n//         setCallConnecting(false);\r\n//         setCallActive(true);\r\n//         setCallStatus('active');\r\n//         callStartTimeRef.current = Date.now();\r\n//         setCallDuration(0);\r\n//         addMessage('system', '‡§ï‡•â‡§≤ ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§π‡•ã ‡§ó‡§à ‡§π‡•à', 'status');\r\n//         reconnectAttempts.current = 0;\r\n//       };\r\n\r\n//       eventSourceRef.current.onmessage = (event) => {\r\n//         try {\r\n//           const data = JSON.parse(event.data);\r\n//           handleRealtimeUpdate(data);\r\n//         } catch (error) {\r\n//           console.error('Error parsing SSE data:', error);\r\n//         }\r\n//       };\r\n\r\n//       eventSourceRef.current.onerror = (error) => {\r\n//         console.error('SSE Error:', error);\r\n        \r\n//         if (reconnectAttempts.current < maxReconnectAttempts) {\r\n//           addMessage('system', '‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ, ‡§™‡•Å‡§®‡§É ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...', 'status');\r\n//           reconnectAttempts.current += 1;\r\n          \r\n//           reconnectTimeoutRef.current = setTimeout(() => {\r\n//             if (callActive) {\r\n//               setupSSEConnection();\r\n//             }\r\n//           }, 2000 * reconnectAttempts.current); // Exponential backoff\r\n//         } else {\r\n//           addMessage('system', '‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§≤‡§ó‡§æ‡§§‡§æ‡§∞ ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§¶‡•ã‡§¨‡§æ‡§∞‡§æ ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç‡•§', 'error');\r\n//           endCall();\r\n//         }\r\n//       };\r\n\r\n//     } catch (error) {\r\n//       console.error('Error setting up SSE:', error);\r\n//       setConnectionError(error.message);\r\n//       endCall();\r\n//     }\r\n//   };\r\n\r\n//   const handleRealtimeUpdate = useCallback((data) => {\r\n//     if (!data || !data.type) return;\r\n\r\n//     console.log('Received update:', data.type, data);\r\n\r\n//     switch (data.type) {\r\n//       case 'connected':\r\n//         addMessage('system', '‡§ï‡•â‡§≤ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§π‡•Å‡§à', 'status');\r\n//         break;\r\n\r\n//       case 'bot_question':\r\n//       case 'bot_speaking':\r\n//         setIsSpeaking(true);\r\n//         setCurrentStep(data.step || '‡§¨‡•ã‡§ü ‡§¨‡•ã‡§≤ ‡§∞‡§π‡§æ ‡§π‡•à');\r\n//         addMessage('bot', data.message, 'text', { step: data.step });\r\n//         // Simulate speaking duration based on message length\r\n//         const speakingDuration = Math.max(2000, data.message.length * 100);\r\n//         setTimeout(() => setIsSpeaking(false), speakingDuration);\r\n//         break;\r\n        \r\n//       case 'listening_start':\r\n//         setIsListening(true);\r\n//         setIsSpeaking(false);\r\n//         setIsProcessing(false);\r\n//         setCurrentStep('‡§Ü‡§™‡§ï‡•Ä ‡§Ü‡§µ‡§æ‡§ú‡§º ‡§∏‡•Å‡§® ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...');\r\n//         addMessage('system', '‡§Ö‡§¨ ‡§¨‡•ã‡§≤‡•á‡§Ç...', 'status');\r\n//         break;\r\n        \r\n//       case 'listening_end':\r\n//         setIsListening(false);\r\n//         setCurrentStep('‡§Ü‡§™‡§ï‡•Ä ‡§¨‡§æ‡§§ ‡§∏‡§Æ‡§ù ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...');\r\n//         break;\r\n        \r\n//       case 'user_response':\r\n//         setIsProcessing(false);\r\n//         addMessage('user', data.message, 'text');\r\n//         setCurrentStep('');\r\n//         break;\r\n        \r\n//       case 'processing':\r\n//         setIsProcessing(true);\r\n//         setCurrentStep(data.message || '‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏‡§ø‡§Ç‡§ó...');\r\n//         break;\r\n        \r\n//       case 'complaint_structured':\r\n//         setCallStatus('processing');\r\n//         addMessage('bot', '‡§Ü‡§™‡§ï‡•Ä ‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•ã ‡§ó‡§Ø‡§æ:', 'status');\r\n//         if (data.data) {\r\n//           addMessage('bot', JSON.stringify(data.data, null, 2), 'json', { complaintData: data.data });\r\n//         }\r\n//         break;\r\n        \r\n//       case 'complaint_submitted':\r\n//         setCallStatus('completed');\r\n//         setComplaintId(data.complaintId);\r\n//         addMessage('bot', `‡§Ü‡§™‡§ï‡•Ä ‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§¶‡§∞‡•ç‡§ú ‡§π‡•ã ‡§ó‡§à ‡§π‡•à!`, 'status');\r\n//         addMessage('bot', `‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§®‡§Ç‡§¨‡§∞: ${data.complaintId}`, 'text', { complaintId: data.complaintId });\r\n//         setCurrentStep('‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§¶‡§∞‡•ç‡§ú ‡§π‡•ã ‡§ó‡§à');\r\n//         // Auto end call after 5 seconds\r\n//         setTimeout(() => endCall(), 5000);\r\n//         break;\r\n        \r\n//       case 'summary':\r\n//         addMessage('bot', data.message, 'status');\r\n//         break;\r\n        \r\n//       case 'final_message':\r\n//         addMessage('bot', data.message, 'status');\r\n//         break;\r\n        \r\n//       case 'error':\r\n//         addMessage('bot', data.message, 'error');\r\n//         setCallStatus('error');\r\n//         break;\r\n\r\n//       case 'retry':\r\n//         addMessage('system', data.message, 'status');\r\n//         break;\r\n\r\n//       case 'validation_error':\r\n//         addMessage('bot', data.message, 'error');\r\n//         break;\r\n\r\n//       case 'session_ended':\r\n//         addMessage('system', '‡§ï‡•â‡§≤ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã ‡§ó‡§à', 'status');\r\n//         endCall();\r\n//         break;\r\n\r\n//       case 'heartbeat':\r\n//         // Keep connection alive, don't show to user\r\n//         break;\r\n        \r\n//       default:\r\n//         console.log('Unknown message type:', data.type, data);\r\n//     }\r\n//   }, [addMessage]);\r\n\r\n//   const endCall = async () => {\r\n//     try {\r\n//       // Stop backend session\r\n//       if (sessionId) {\r\n//         await fetch('http://localhost:5000/api/stop-voice-session', { \r\n//           method: 'POST',\r\n//           credentials: 'include'\r\n//         });\r\n//       }\r\n//     } catch (error) {\r\n//       console.error('Error stopping session:', error);\r\n//     }\r\n\r\n//     // Cleanup local state\r\n//     if (eventSourceRef.current) {\r\n//       eventSourceRef.current.close();\r\n//       eventSourceRef.current = null;\r\n//     }\r\n\r\n//     if (callTimerRef.current) {\r\n//       clearInterval(callTimerRef.current);\r\n//       callTimerRef.current = null;\r\n//     }\r\n\r\n//     if (reconnectTimeoutRef.current) {\r\n//       clearTimeout(reconnectTimeoutRef.current);\r\n//       reconnectTimeoutRef.current = null;\r\n//     }\r\n\r\n//     setCallActive(false);\r\n//     setCallConnecting(false);\r\n//     setIsListening(false);\r\n//     setIsProcessing(false);\r\n//     setIsSpeaking(false);\r\n//     setCurrentStep('');\r\n//     setSessionId(null);\r\n//     callStartTimeRef.current = null;\r\n//     setCallDuration(0);\r\n    \r\n//     if (callStatus !== 'completed') {\r\n//       setCallStatus('idle');\r\n//       addMessage('system', '‡§ï‡•â‡§≤ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã ‡§ó‡§à', 'status');\r\n//     }\r\n//   };\r\n\r\n//   const formatMessage = (msg) => {\r\n//     if (msg.type === 'json') {\r\n//       try {\r\n//         const data = JSON.parse(msg.message);\r\n//         return (\r\n//           <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3 mt-2\">\r\n//             <h4 className=\"font-semibold text-blue-800 mb-2\">‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£:</h4>\r\n//             <div className=\"space-y-1 text-sm\">\r\n//               {data[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ\"] && (\r\n//                 <p><span className=\"font-medium\">‡§®‡§æ‡§Æ:</span> {data[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ\"]}</p>\r\n//               )}\r\n//               {data[\"‡§∏‡•ç‡§•‡§æ‡§®\"] && (\r\n//                 <p><span className=\"font-medium\">‡§∏‡•ç‡§•‡§æ‡§®:</span> {data[\"‡§∏‡•ç‡§•‡§æ‡§®\"]}</p>\r\n//               )}\r\n//               {data[\"‡§µ‡§ø‡§≠‡§æ‡§ó\"] && (\r\n//                 <p><span className=\"font-medium\">‡§µ‡§ø‡§≠‡§æ‡§ó:</span> {data[\"‡§µ‡§ø‡§≠‡§æ‡§ó\"]}</p>\r\n//               )}\r\n//               {data[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§\"] && (\r\n//                 <p><span className=\"font-medium\">‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§:</span> {data[\"‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§\"]}</p>\r\n//               )}\r\n//               {data[\"‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞\"] && (\r\n//                 <p><span className=\"font-medium\">‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤:</span> {data[\"‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞\"]}</p>\r\n//               )}\r\n//             </div>\r\n//           </div>\r\n//         );\r\n//       } catch (e) {\r\n//         return <pre className=\"text-xs bg-gray-100 p-2 rounded overflow-x-auto\">{msg.message}</pre>;\r\n//       }\r\n//     }\r\n//     return msg.message;\r\n//   };\r\n\r\n//   const getMessageIcon = (msg) => {\r\n//     if (msg.sender === 'bot') {\r\n//       if (msg.type === 'error') return <AlertCircle className=\"w-4 h-4 text-red-500\" />;\r\n//       if (msg.type === 'status') return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\r\n//       return <Bot className=\"w-4 h-4 text-blue-500\" />;\r\n//     }\r\n//     if (msg.sender === 'system') {\r\n//       return <Signal className=\"w-4 h-4 text-gray-500\" />;\r\n//     }\r\n//     return <User className=\"w-4 h-4 text-purple-500\" />;\r\n//   };\r\n\r\n//   const getCallStatusColor = () => {\r\n//     switch (callStatus) {\r\n//       case 'connecting': return 'text-yellow-600 bg-yellow-100 border-yellow-200';\r\n//       case 'active': return 'text-green-600 bg-green-100 border-green-200';\r\n//       case 'processing': return 'text-blue-600 bg-blue-100 border-blue-200';\r\n//       case 'completed': return 'text-green-600 bg-green-100 border-green-200';\r\n//       case 'error': return 'text-red-600 bg-red-100 border-red-200';\r\n//       default: return 'text-gray-600 bg-gray-100 border-gray-200';\r\n//     }\r\n//   };\r\n\r\n//   const getCallStatusText = () => {\r\n//     switch (callStatus) {\r\n//       case 'connecting': return '‡§ï‡§®‡•á‡§ï‡•ç‡§ü ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...';\r\n//       case 'active': return '‡§ï‡•â‡§≤ ‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø';\r\n//       case 'processing': return '‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏ ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à';\r\n//       case 'completed': return '‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§™‡•Ç‡§∞‡•ç‡§£';\r\n//       case 'error': return '‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ';\r\n//       default: return '‡§§‡•à‡§Ø‡§æ‡§∞';\r\n//     }\r\n//   };\r\n\r\n//   return (\r\n//     <div className=\"max-w-4xl mx-auto mt-6 p-6 bg-white rounded-xl shadow-lg\">\r\n//       {/* Header */}\r\n//       <div className=\"text-center mb-6\">\r\n//         <div className=\"flex items-center justify-center mb-4\">\r\n//           <PhoneCall className=\"w-8 h-8 text-blue-600 mr-3\" />\r\n//           <h2 className=\"text-3xl font-bold text-gray-900\">‡§ú‡§®‡§§‡§æ ‡§µ‡•â‡§á‡§∏ ‡§ï‡•â‡§≤</h2>\r\n//         </div>\r\n//         <p className=\"text-gray-600\">‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§®‡•Ä ‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç</p>\r\n//       </div>\r\n\r\n//       {/* Call Status Bar */}\r\n//       <div className={`flex items-center justify-between p-4 rounded-lg mb-6 border ${getCallStatusColor()}`}>\r\n//         <div className=\"flex items-center space-x-3\">\r\n//           <div className=\"flex items-center space-x-2\">\r\n//             {callConnecting && <Clock className=\"w-5 h-5 animate-spin\" />}\r\n//             {callActive && !isListening && !isSpeaking && !isProcessing && (\r\n//               <Signal className=\"w-5 h-5 animate-pulse\" />\r\n//             )}\r\n//             {isListening && <Mic className=\"w-5 h-5 animate-pulse text-green-600\" />}\r\n//             {isSpeaking && <Volume2 className=\"w-5 h-5 animate-pulse text-blue-600\" />}\r\n//             {isProcessing && <Clock className=\"w-5 h-5 animate-spin text-yellow-600\" />}\r\n//             <span className=\"font-medium\">\r\n//               {currentStep || getCallStatusText()}\r\n//             </span>\r\n//           </div>\r\n//         </div>\r\n//         <div className=\"text-sm font-mono\">\r\n//           {callActive && `${formatTime(callDuration)}`}\r\n//         </div>\r\n//       </div>\r\n\r\n//       {/* Call Control */}\r\n//       <div className=\"flex justify-center mb-6\">\r\n//         {!callActive && !callConnecting ? (\r\n//           <button\r\n//             onClick={startCall}\r\n//             disabled={callConnecting}\r\n//             className=\"flex items-center space-x-3 bg-green-600 text-white px-8 py-4 rounded-full hover:bg-green-700 transition-colors font-medium text-lg shadow-lg transform hover:scale-105\"\r\n//           >\r\n//             <Phone className=\"w-6 h-6\" />\r\n//             <span>‡§ï‡•â‡§≤ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</span>\r\n//           </button>\r\n//         ) : (\r\n//           <button\r\n//             onClick={endCall}\r\n//             className=\"flex items-center space-x-3 bg-red-600 text-white px-8 py-4 rounded-full hover:bg-red-700 transition-colors font-medium text-lg shadow-lg transform hover:scale-105\"\r\n//           >\r\n//             <PhoneOff className=\"w-6 h-6\" />\r\n//             <span>‡§ï‡•â‡§≤ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç</span>\r\n//           </button>\r\n//         )}\r\n//       </div>\r\n\r\n//       {/* Connection Error */}\r\n//       {connectionError && (\r\n//         <div className=\"mb-4 p-3 bg-red-100 border border-red-200 text-red-700 rounded-lg\">\r\n//           <div className=\"flex items-center space-x-2\">\r\n//             <AlertCircle className=\"w-5 h-5\" />\r\n//             <span>‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§è‡§∞‡§∞: {connectionError}</span>\r\n//           </div>\r\n//         </div>\r\n//       )}\r\n\r\n//       {/* Call Log */}\r\n//       <div \r\n//         ref={conversationRef}\r\n//         className=\"bg-gray-900 text-white rounded-lg p-4 h-96 overflow-y-auto border border-gray-700\"\r\n//         style={{\r\n//           background: 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)',\r\n//           fontFamily: 'monospace'\r\n//         }}\r\n//       >\r\n//         {conversation.length === 0 ? (\r\n//           <div className=\"flex items-center justify-center h-full text-gray-400\">\r\n//             <div className=\"text-center\">\r\n//               <PhoneCall className=\"w-12 h-12 mx-auto mb-3 text-gray-500\" />\r\n//               <p>‡§ï‡•â‡§≤ ‡§≤‡•â‡§ó ‡§Ø‡§π‡§æ‡§Å ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§ú‡§æ‡§è‡§ó‡§æ...</p>\r\n//             </div>\r\n//           </div>\r\n//         ) : (\r\n//           <div className=\"space-y-3\">\r\n//             {conversation.map((msg) => (\r\n//               <div\r\n//                 key={msg.id}\r\n//                 className=\"flex items-start space-x-3\"\r\n//               >\r\n//                 <div className=\"flex-shrink-0 text-xs text-gray-400 w-16\">\r\n//                   {msg.timestamp.toLocaleTimeString('hi-IN', { \r\n//                     hour12: false,\r\n//                     hour: '2-digit',\r\n//                     minute: '2-digit',\r\n//                     second: '2-digit'\r\n//                   })}\r\n//                 </div>\r\n//                 <div className={`flex-shrink-0 p-1 rounded-full ${\r\n//                   msg.sender === 'user' ? 'bg-purple-600' : \r\n//                   msg.sender === 'system' ? 'bg-gray-600' :\r\n//                   msg.type === 'error' ? 'bg-red-600' :\r\n//                   msg.type === 'status' ? 'bg-green-600' : 'bg-blue-600'\r\n//                 }`}>\r\n//                   {getMessageIcon(msg)}\r\n//                 </div>\r\n//                 <div className=\"flex-1\">\r\n//                   <div className={`text-sm ${\r\n//                     msg.sender === 'user' \r\n//                       ? 'text-purple-300' \r\n//                       : msg.sender === 'system'\r\n//                       ? 'text-gray-300'\r\n//                       : msg.type === 'error'\r\n//                       ? 'text-red-300'\r\n//                       : msg.type === 'status'\r\n//                       ? 'text-green-300'\r\n//                       : 'text-blue-300'\r\n//                   }`}>\r\n//                     <span className=\"font-medium\">\r\n//                       {msg.sender === 'user' ? '‡§Ü‡§™' : \r\n//                        msg.sender === 'system' ? '‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ' : '‡§¨‡•â‡§ü'}:\r\n//                     </span>\r\n//                   </div>\r\n//                   <div className=\"text-white text-sm mt-1 break-words\">\r\n//                     {formatMessage(msg)}\r\n//                   </div>\r\n//                 </div>\r\n//               </div>\r\n//             ))}\r\n//           </div>\r\n//         )}\r\n//       </div>\r\n\r\n//       {/* Current Activity Indicator */}\r\n//       {callActive && (\r\n//         <div className=\"mt-4 flex items-center justify-center space-x-4 text-sm\">\r\n//           {isListening && (\r\n//             <div className=\"flex items-center space-x-2 bg-green-100 px-4 py-2 rounded-full border border-green-200\">\r\n//               <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\r\n//               <Mic className=\"w-4 h-4 text-green-600\" />\r\n//               <span className=\"text-green-700 font-medium\">‡§∏‡•Å‡§® ‡§∞‡§π‡•á ‡§π‡•à‡§Ç...</span>\r\n//             </div>\r\n//           )}\r\n//           {isSpeaking && (\r\n//             <div className=\"flex items-center space-x-2 bg-blue-100 px-4 py-2 rounded-full border border-blue-200\">\r\n//               <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\"></div>\r\n//               <Volume2 className=\"w-4 h-4 text-blue-600\" />\r\n//               <span className=\"text-blue-700 font-medium\">‡§¨‡•â‡§ü ‡§¨‡•ã‡§≤ ‡§∞‡§π‡§æ ‡§π‡•à...</span>\r\n//             </div>\r\n//           )}\r\n//           {isProcessing && (\r\n//             <div className=\"flex items-center space-x-2 bg-yellow-100 px-4 py-2 rounded-full border border-yellow-200\">\r\n//               <div className=\"w-2 h-2 bg-yellow-500 rounded-full animate-pulse\"></div>\r\n//               <Clock className=\"w-4 h-4 text-yellow-600\" />\r\n//               <span className=\"text-yellow-700 font-medium\">‡§™‡•ç‡§∞‡•ã‡§∏‡•á‡§∏‡§ø‡§Ç‡§ó...</span>\r\n//             </div>\r\n//           )}\r\n//         </div>\r\n//       )}\r\n\r\n//       {/* Final Result */}\r\n//       {complaintId && (\r\n//         <div className=\"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg\">\r\n//           <div className=\"flex items-center justify-between\">\r\n//             <div>\r\n//               <h3 className=\"font-semibold text-green-800 flex items-center space-x-2\">\r\n//                 <CheckCircle className=\"w-5 h-5\" />\r\n//                 <span>‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§¶‡§∞‡•ç‡§ú!</span>\r\n//               </h3>\r\n//               <p className=\"text-green-700 mt-1\">\r\n//                 ‡§Ü‡§™‡§ï‡§æ ‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§®‡§Ç‡§¨‡§∞: <span className=\"font-mono font-bold text-lg\">{complaintId}</span>\r\n//               </p>\r\n//               <p className=\"text-green-600 text-sm mt-1\">\r\n//                 ‡§ï‡•É‡§™‡§Ø‡§æ ‡§á‡§∏ ‡§®‡§Ç‡§¨‡§∞ ‡§ï‡•ã ‡§Ö‡§™‡§®‡•á ‡§™‡§æ‡§∏ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§∞‡§ñ‡•á‡§Ç\r\n//               </p>\r\n//             </div>\r\n//           </div>\r\n//         </div>\r\n//       )}\r\n\r\n//       {/* Audio Controls */}\r\n//       <div className=\"mt-4 flex justify-center\">\r\n//         <button\r\n//           onClick={() => setAudioEnabled(!audioEnabled)}\r\n//           className={`flex items-center space-x-2 px-4 py-2 rounded-lg text-sm ${\r\n//             audioEnabled \r\n//               ? 'bg-green-100 text-green-700 hover:bg-green-200' \r\n//               : 'bg-red-100 text-red-700 hover:bg-red-200'\r\n//           } transition-colors`}\r\n//         >\r\n//           {audioEnabled ? <Volume2 className=\"w-4 h-4\" /> : <VolumeX className=\"w-4 h-4\" />}\r\n//           <span>{audioEnabled ? '‡§Ü‡§µ‡§æ‡§ú‡§º ‡§ö‡§æ‡§≤‡•Ç' : '‡§Ü‡§µ‡§æ‡§ú‡§º ‡§¨‡§Ç‡§¶'}</span>\r\n//         </button>\r\n//       </div>\r\n//     </div>\r\n//   );\r\n// }"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,QAAQ,OAAO;AACvC,OAAOC,KAAK,MAAM,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE1B,eAAe,SAASC,cAAcA,CAAA,EAAG;EAAAC,EAAA;EACvC,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGP,QAAQ,CAAC,EAAE,CAAC;EACpC,MAAM,CAACQ,OAAO,EAAEC,UAAU,CAAC,GAAGT,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAACU,WAAW,EAAEC,cAAc,CAAC,GAAGX,QAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAACY,SAAS,EAAEC,YAAY,CAAC,GAAGb,QAAQ,CAAC,KAAK,CAAC;EAEjD,MAAMc,SAAS,GAAIC,IAAI,IAAK;IAC1BR,OAAO,CAAES,IAAI,IAAK,CAAC,GAAGA,IAAI,EAAED,IAAI,CAAC,CAAC;EACpC,CAAC;EAED,MAAME,oBAAoB,GAAG,MAAAA,CAAA,KAAY;IACvCR,UAAU,CAAC,IAAI,CAAC;IAChBF,OAAO,CAAC,CAAC,gCAAgC,CAAC,CAAC;IAC3CM,YAAY,CAAC,KAAK,CAAC;IACnBF,cAAc,CAAC,IAAI,CAAC;IAEpB,IAAI;MACF;MACA,MAAMO,QAAQ,GAAG,MAAMjB,KAAK,CAACkB,GAAG,CAAC,4BAA4B,CAAC;MAC9D,IAAID,QAAQ,CAACE,IAAI,CAACC,MAAM,KAAK,SAAS,EAAE;QACtCP,SAAS,CAAC,qBAAqB,GAAGI,QAAQ,CAACE,IAAI,CAACE,OAAO,CAAC;QACxD;MACF;MAEA,MAAMC,aAAa,GAAGL,QAAQ,CAACE,IAAI,CAACA,IAAI;MACxCN,SAAS,CAAC,6BAA6B,CAAC;MACxCA,SAAS,CAACU,IAAI,CAACC,SAAS,CAACF,aAAa,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;;MAEjD;MACA,MAAMG,OAAO,GAAG,MAAMzB,KAAK,CAAC0B,IAAI,CAC9B,qCAAqC,EACrC;QACEC,IAAI,EAAEL,aAAa,CAAC,oBAAoB,CAAC,IAAIA,aAAa,CAACK,IAAI;QAC/DC,SAAS,EAAEN,aAAa,CAAC,QAAQ,CAAC,IAAIA,aAAa,CAACM,SAAS;QAC7DC,QAAQ,EAAEP,aAAa,CAAC,OAAO,CAAC,IAAIA,aAAa,CAACO;QAClD;MACF,CACF,CAAC;;MAED;MACA,MAAMC,KAAK,GAAGL,OAAO,CAACN,IAAI,CAACV,WAAW,IAAIgB,OAAO,CAACN,IAAI,CAACV,WAAW;MAClEC,cAAc,CAACoB,KAAK,CAAC;MACrBlB,YAAY,CAAC,IAAI,CAAC;MAClBC,SAAS,CAAC,+BAA+BiB,KAAK,EAAE,CAAC;IACnD,CAAC,CAAC,OAAOC,GAAG,EAAE;MACZlB,SAAS,CAAC,WAAW,GAAGkB,GAAG,CAACV,OAAO,CAAC;IACtC,CAAC,SAAS;MACRb,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC;EAED,oBACEN,OAAA;IAAK8B,SAAS,EAAC,oDAAoD;IAAAC,QAAA,gBACjE/B,OAAA;MAAI8B,SAAS,EAAC,6BAA6B;MAAAC,QAAA,EAAC;IAAe;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAChEnC,OAAA;MACEoC,OAAO,EAAEtB,oBAAqB;MAC9BuB,QAAQ,EAAEhC,OAAQ;MAClByB,SAAS,EAAC,gFAAgF;MAAAC,QAAA,EAEzF1B,OAAO,GAAG,eAAe,GAAG;IAAuB;MAAA2B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC9C,CAAC,eAETnC,OAAA;MAAK8B,SAAS,EAAC,8EAA8E;MAAAC,QAAA,EAC1F5B,IAAI,CAACmC,GAAG,CAAC,CAAC1B,IAAI,EAAE2B,CAAC,kBAChBvC,OAAA;QAAA+B,QAAA,EAAcnB;MAAI,GAAR2B,CAAC;QAAAP,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAa,CACzB;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACC,CAAC,EAEL1B,SAAS,iBACRT,OAAA;MAAK8B,SAAS,EAAC,mCAAmC;MAAAC,QAAA,GAAC,mCAChB,eAAA/B,OAAA;QAAAgC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,uBACpB,eAAAnC,OAAA;QAAM8B,SAAS,EAAC,WAAW;QAAAC,QAAA,EAAExB;MAAW;QAAAyB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAChE,CACN;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV;;AAIA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAAjC,EAAA,CAlxBwBD,cAAc;AAAAuC,EAAA,GAAdvC,cAAc;AAAA,IAAAuC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}